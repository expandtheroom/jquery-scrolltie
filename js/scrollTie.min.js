!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){"use strict";function b(b,c,d){this.id=c.id,this.el="string"==typeof b?document.querySelector(b):b,this.$el=a(b),this.container=c.container?this.$el.parents(c.container)[0]:d,this.animateWhenOutOfView=c.animateWhenOutOfView,this.reverseDirection=c.reverseDirection,this.property=i[c.property]||c.property,this.transform="transform"===this.property?c.property:null,this.backgroundPositionAxis="backgroundPosition"===this.property?c.property:null,this.evt=c.evt||"scroll",this.context=c.context||f,this.speed=c.speed||1,this.delay=c.delay,this.stopAtValue=c.stopAtValue,this.originalVal=c.originalVal,this.propertyValueFormat=c.propertyValueFormat,this.afterStop=c.afterStop||a.noop,this.onPause=c.onPause||a.noop,this.onStart=c.onStart||a.noop,this.onDestroy=c.onDestroy||a.noop,this.$win=a(f),this.$doc=a(document),this.$context=a(this.context),this.lastScrollY=this.getScrollY(),this.isQueued=!1,this.paused=!1,this.stopped=!1,this.resizeTicker=0,this.lastFrameWasAnimated=!1,f.requestAnimationFrame=f.requestAnimationFrame||f.webkitRequestAnimationFrame||f.mozRequestAnimationFrame,this.raf=!!f.requestAnimationFrame,c.manualInit||this.init()}function c(a){var b=f.getComputedStyle(a,null);if(a&&b){var c=b.getPropertyValue("-webkit-transform")||b.getPropertyValue("-moz-transform")||b.getPropertyValue("-ms-transform")||b.getPropertyValue("-o-transform")||b.getPropertyValue("transform"),d=c.replace(/[matrix\(\)]/g,"").split(","),e=d[0],g=d[1],h=(d[2],d[3],d[4]),i=d[5],j=Math.sqrt(e*e+g*g),k=Math.round(Math.atan2(g,e)*(180/Math.PI));return{rotate:parseInt(k),scale:j,translateX:parseInt(h),translateY:parseInt(i)}}}var d,e,f=window,g=[],h=0,i={translateY:"transform",translateX:"transform",rotate:"transform",scale:"transform",backgroundPositionY:"backgroundPosition",backgroundPositionX:"backgroundPosition"},j=["-ms-","-webkit-"];a.extend(b.prototype,{init:function(){var a=this;this.isFixed="fixed"==this.$el.css("position"),this.originalVal=void 0!==this.originalVal?this.originalVal:this.calculateOriginalVal(),this.calculatedDelay=this.calculateDelay(),this.staticTransformValue=this.getStaticTransformValue(),("function"!=typeof this.propertyValueFormat&&this.transform||this.backgroundPositionAxis)&&(this.propertyValueFormat=this.getSpecialPropertyValueFormat(this.transform||this.backgroundPositionAxis)),this.canAnimate()&&this.animate(),this.$context.on(this.evt+"."+this.id,this.scrollHandler.bind(this)),this.$win.on("resize."+this.id,function(){a.resizeTicker++,a.resetPosition(a.resizeTicker)})},scrollHandler:function(){this.lastScrollY=this.getScrollY(),this.requestAnimation()},requestAnimation:function(){return this.$win.height()+this.lastScrollY>this.$doc.height()?void 0:this.canAnimate()?this.raf?void(this.isQueued||(f.requestAnimationFrame(this.animate.bind(this)),this.isQueued=!0)):void this.animate():(this.lastFrameWasAnimated&&this.animateTo(this.originalVal),void(this.lastFrameWasAnimated=!1))},canAnimate:function(){var a=this.container||this.el,b=this.elementIsInView(a),c=this.paused||!b&&!this.animateWhenOutOfView&&!this.isFixed||this.lastScrollY<this.calculatedDelay;return!c},animate:function(){this.isQueued=!1,this.lastFrameWasAnimated||this.onStart(this.el);var a=this.calculateMoveValue();this.propertyValueFormat&&(a=this.propertyValueFormat(this.$el[0],a)),this.updatePropertyValue(a),this.stopped&&this.checkforRestart(),this.lastFrameWasAnimated=!0},animateTo:function(a){this.originalVal=[a],this.propertyValueFormat&&(a=this.propertyValueFormat(this.el,a)),this.updatePropertyValue(a)},getScrollY:function(){return this.$context.scrollTop()},updatePropertyValue:function(b){var c=this;if(this.transform){var d={transform:c.staticTransformValue+" "+b};a.each(j,function(a,e){d[e+"transform"]=c.staticTransformValue+" "+b}),this.$el.css(d)}else this.$el.css(this.property,b)},getStaticTransformValue:function(){var a="",b=c(this.el);for(var d in b){var e=this.getSpecialPropertyValueFormat(d);b[d]&&d!==this.transform&&(a=a+" "+e(this.el,b[d]))}return a},getSpecialPropertyValueFormat:function(a){var b;switch(a){case"translateX":b=function(a,b){return"translateX("+b+"px)"};break;case"translateY":b=function(a,b){return"translateY("+b+"px)"};break;case"rotate":b=function(a,b){return"rotate("+b+"deg)"};break;case"scale":b=function(a,b){return"scale("+b+")"};break;case"backgroundPositionX":b=function(a,b){var c=getComputedStyle(a)?getComputedStyle(a).backgroundPosition.split(" ")[1]:0;return b+"px "+c};break;case"backgroundPositionY":b=function(a,b){var c=getComputedStyle(a)?getComputedStyle(a).backgroundPosition.split(" ")[0]:0;return c+" "+b+"px"};break;default:b=null}return b},calculateOriginalVal:function(){if(this.transform){var a=c(this.el);return parseInt(a&&a[this.transform]?a[this.transform]:0)}if(this.backgroundPositionAxis){var b=getComputedStyle(this.el).backgroundPosition.split(" ");return parseInt("backgroundPositionX"===this.backgroundPositionAxis?b[0]:b[1])}return parseInt(this.$el.css(this.property))||0},calculateDelay:function(){var a=this.$el.offset().top;a=a>f.innerHeight&&!this.isFixed?a-f.innerHeight:0;var b="function"==typeof this.delay?this.delay(this.el):this.delay;return void 0===b?a:b+a},calculateMoveValue:function(){var a=(this.lastScrollY-this.calculatedDelay)*this.speed;return"scale"==this.transform&&(a=.01*a),a=this.reverseDirection?Number(this.originalVal)-a:Number(this.originalVal)+a,void 0!==this.stopAtValue&&(a=this.checkForStop(a)),"scale"==this.transform?a:Math.floor(a)},checkForStop:function(a){return(!this.reverseDirection&&a>=this.stopAtValue||this.reverseDirection&&a<=this.stopAtValue)&&(a=this.stopAtValue,this.afterStop(this.el),this.stopped=!0),a},checkforRestart:function(a){this.originalVal<this.stopAtValue&&a<=this.stopAtValue?(this.onStart(this.el),this.stopped=!1):this.originalVal>this.stopAtValue&&a>=this.stopAtValue&&(this.onStart(this.el),this.stopped=!1)},elementIsInView:function(a,b){b=b||100;var c=document.body,d=document.documentElement,e=(Math.max(c.scrollHeight,d.scrollHeight,c.offsetHeight,d.offsetHeight,c.clientHeight,d.clientHeight),f.innerHeight||document.documentElement.clientHeight||document.body.clientHeight),g=this.lastScrollY+e,h=a.offsetTop,i=a.clientHeight,j=g+b>=h&&h+i+e+b>g;return j},resetPosition:function(a){var b=this;setTimeout(function(){a==b.resizeTicker&&b.refresh()},500)},clearProperty:function(){var b=this;this.$el.css(this.property,""),this.transform&&a.each(j,function(a,c){b.$el.css(c+"transform","")})},pause:function(){this.paused=!0,this.onPause(this.el)},start:function(){this.paused=!1,this.originalVal=this.calculateOriginalVal(),this.calculatedDelay=this.lastScrollY,this.onStart(this.el)},destroy:function(){this.$context.off("."+this.id),this.$win.off("."+this.id),this.clearProperty(),a.removeData(this.el,"plugin_scrollTie"),g.splice(g.indexOf(this)-1,1),this.onDestroy(this.el)},refresh:function(){this.clearProperty(),this.init()}}),d={destroy:function(){a.each(g,function(a,b){b.destroy()})},pause:function(){a.each(g,function(a,b){b.pause()})},restart:function(){a.each(g,function(a,b){b.start()})},refresh:function(){a.each(g,function(a,b){b.refresh()})}},e={destroy:function(){return this.destroy(),this.$el},pause:function(){return this.pause(),this.$el},restart:function(){return this.start(),this.$el},refresh:function(){return this.refresh(),this.$el}},a.fn.scrollTie=function(c){if("string"==typeof c||!c){var d=c;return a(this).data().plugin_scrollTie?e[d]?e[d].apply(a(this).data().plugin_scrollTie):a.error(d?"ScrollTie doesn't recognize the method "+d:"ScrollTie needs a string reference to a public method or option configuration object."):a.error("ScrollTie not instantiated on this element")}return this.each(function(){if(!a.data(this,"plugin_scrollTie")){c.id="scrollTied"+h++;var d=new b(this,c);g.push(d),a.data(this,"plugin_scrollTie",d)}})},a.scrollTie=function(){var a=arguments[0],b=arguments.length>=2?[].slice.call(arguments,1):[];return d[a]?d[a].apply(null,b):g}});